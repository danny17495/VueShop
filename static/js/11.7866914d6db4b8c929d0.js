webpackJsonp([11],{InPl:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=s("7t+N"),i=s.n(e),n={data:function(){return{cart:{},cartLength:"",coupon_code:"",cartData:{},couponResponse:"",isConfirm:!1,isNext:!1,isLoading:!1}},methods:{getCart:function(){var t=this;t.isLoading=!0;t.$http.get("https://vue-course-api.hexschool.io/api/danny17495/cart").then(function(a){t.isLoading=!1,t.myCarts=a.data.data,console.log("getCart",a.data.data)})},removeCartItem:function(t){var a=this,s="https://vue-course-api.hexschool.io/api/danny17495/cart/"+t;a.$http.delete(s).then(function(){a.getCart(),a.$bus.$emit("updateBag")})},changeQty:function(t,a){var s=parseInt(t.qty+a,10);this.changeNumber(t),console.log("數量",s)},changeNumber:function(t,a){var s=this,e=-1;s.cart.length>0&&s.cart.forEach(function(a,s){a.id===t.id&&(e=s)}),s.cart[e].qty=a>=10?10:a<=1?1:t.qty;var i=parseInt(s.cart[e].price*s.cart[e].qty,10);s.cart[e].total=i,s.getCart()},getCartData:function(){var t=this;t.$http.get("https://vue-course-api.hexschool.io/api/danny17495/cart").then(function(a){t.isLoading=!1,t.cartData=a.data.data})},addCouponCode:function(){var t=this,a={code:t.coupon_code};t.$http.post("https://vue-course-api.hexschool.io/api/danny17495/coupon",{data:a}).then(function(a){a.data.success?(t.couponResponse=a.data.message,t.getCartData()):t.couponResponse=a.data.message})},goNextPage:function(){this.isNext=!0,this.$router.push("/shopping/OrderPayment")}},created:function(){var t=this;t.getCart(),t.getCartData(),t.$bus.$on("checkCart:get",function(){return t.getCart()})},beforeRouteLeave:function(t,a,s){var e=this;e.isNext?s():(i()("#leaveModal").modal("show"),i()(".confirm").on("click",function(){e.removeCartItem(),s()}),i()(".cancel").on("click",function(){s(!1)}))}},o={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"carList"},[s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(a){t.isLoading=a}}}),t._v(" "),s("div",{staticClass:"container"},[t._m(0),t._v(" "),s("div",{staticClass:"row mt-4"},[s("div",{staticClass:"col-md-8 table-responsive"},[s("table",{staticClass:"table table-hover"},[t._m(1),t._v(" "),s("tbody",t._l(t.cartData.carts,function(a){return s("tr",{key:a.id,staticClass:"text-sbbrown"},[s("td",{staticClass:"align-middle"},[s("button",{staticClass:"btn btn-outline-sbtan border-0",attrs:{type:"button"},on:{click:function(s){return s.preventDefault(),t.removeCartItem(a.id)}}},[s("i",{staticClass:"fas fa-trash-alt"})])]),t._v(" "),s("td",{staticClass:"productImg align-middle"},[s("img",{staticClass:"img-thumbnail",attrs:{src:a.product.imageUrl}})]),t._v(" "),s("td",{staticClass:"align-middle",on:{click:function(s){return t.$router.push("/shopping/productdetail/"+a.id)}}},[t._v(t._s(a.product.title))]),t._v(" "),s("td",{staticClass:"align-middle text-right editColumn"},[t._v(t._s(a.qty)+"\n                            ")]),t._v(" "),s("td",{staticClass:"align-middle text-right"},[t._v(t._s(t._f("currency")(a.total)))])])}),0),t._v(" "),s("tfoot",[s("tr",{staticClass:"tableTotal"},[s("td",{staticClass:"font-weight-bold text-right",attrs:{colspan:"4"}},[t._v("小計")]),t._v(" "),s("td",{staticClass:"h5 font-weight-bold text-right text-danger"},[t._v(t._s(t._f("currency")(t.cartData.total)))])])])])]),t._v(" "),s("div",{staticClass:"col-md-4 mb-6"},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control ",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.coupon_code},on:{input:function(a){a.target.composing||(t.coupon_code=a.target.value)}}}),t._v(" "),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.addCouponCode}},[t._v("確認")])])]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between my-2 p-2"},[s("span",[t._v("小計")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.cartData.total)))])]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between mb-2 p-2"},[s("span",[t._v("優惠折抵")]),t._v(" "),s("span",{staticClass:"justify-content-end"},[t._v("- "+t._s(t._f("currency")(t.cartData.total-t.cartData.final_total)))])]),t._v(" "),s("p",{staticStyle:{"font-size":"13px",color:"#EA562A"}},[t._v(t._s(t.couponResponse))]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between mb-5 p-2"},[s("span",[t._v("總計")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.cartData.final_total)))])])])]),t._v(" "),s("div",{staticClass:"text-right mt-5 pb-5"},[s("button",{staticClass:"btn btn-secondary mr-2",attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),t.$router.push("shopping/productlist")}}},[t._v("繼續選購")]),t._v(" "),s("button",{staticClass:"btn btn-danger",attrs:{type:"submit"},on:{click:function(a){return a.preventDefault(),t.goNextPage(a)}}},[t._v("下一步")])])]),t._v(" "),t._m(2)],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row text-center p-5"},[a("div",{staticClass:"col-md-3 alert alert-success alert-rounded"},[this._v("\n                確認購物車　　\n                "),a("i",{staticClass:"fas fa-angle-double-right"})]),this._v(" "),a("div",{staticClass:"col-md-3 alert alert-dark alert-rounded"},[this._v("填寫訂單資料")]),this._v(" "),a("div",{staticClass:"col-md-3 alert alert-dark alert-rounded",attrs:{role:"alert"}},[this._v("確認訂單資料")]),this._v(" "),a("div",{staticClass:"col-md-3 alert alert-dark alert-rounded"},[this._v("完成訂購")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",{staticClass:"text-sbbrown font-weight-bold"},[a("th",{attrs:{width:"8%"}}),this._v(" "),a("th",{staticClass:"productTh",attrs:{width:"18%"}}),this._v(" "),a("th",[this._v("商品名稱")]),this._v(" "),a("th",{staticClass:"text-center",attrs:{width:"15%"}},[this._v("數量")]),this._v(" "),a("th",{staticClass:"text-center",attrs:{width:"15%"}},[this._v("金額")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal fade",attrs:{id:"leaveModal",tabindex:"-1",role:"dialog","aria-hidden":"true","data-backdrop":"static"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-body"},[a("p",[this._v("尚未完成訂購流程，請確認是否離開此頁？")])]),this._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary cancel",attrs:{type:"button","data-dismiss":"modal"}},[this._v("取消")]),this._v(" "),a("button",{staticClass:"btn btn-danger confirm",attrs:{type:"button","data-dismiss":"modal"}},[this._v("確定")])])])])])}]},c=s("VU/8")(n,o,!1,null,null,null);a.default=c.exports}});
//# sourceMappingURL=11.7866914d6db4b8c929d0.js.map