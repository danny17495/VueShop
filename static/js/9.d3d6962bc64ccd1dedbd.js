webpackJsonp([9],{k6Aj:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7t+N"),r=s.n(a),i={data:function(){return{form:{user:{name:"",email:"",tel:"",address:"",payment:"selected"},message:""},isLoading:!1,isNext:!1,cartData:{},isConfirm:!1}},methods:{creatrOrder:function(){var t=this,e=t.form;t.isLoading=!0,t.isNext=!0,t.$http.post("https://vue-course-api.hexschool.io/api/danny17495/order",{data:e}).then(function(e){if(e.data.success){localStorage.removeItem("cart"),t.$bus.$emit("cart:get");var s=e.data.orderId;t.$router.push("/shopping/OrderInfo/"+s)}else t.$bus.$emit("message:push",e.data.message,"danger"),t.$router.push("/shopping/productlist")})},goBack:function(){this.isNext=!0,this.$router.go(-1)},cancelCart:function(){var t=this;t.$http.get("https://vue-course-api.hexschool.io/api/danny17495/cart").then(function(e){e.data.success?(t.cartData=e.data.data,t.cartData.carts.length>0?t.isConfirm=!0:t.isConfirm=!1,t.isConfirm&&t.cartData.carts.forEach(function(e){var s="https://vue-course-api.hexschool.io/api/danny17495/cart/"+e.id;t.$http.delete(s).then(function(e){e.data.success||t.$bus.$emit("message:push",e.data.message,"danger")})})):t.$bus.$emit("message:push",e.data.message,"danger")})}},beforeRouteLeave:function(t,e,s){var a=this;a.isNext?s():(r()("#leaveModal").modal("show"),r()(".confirm").on("click",function(){a.cancelCart(),s()}),r()(".cancel").on("click",function(){s(!1)}))}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"orderPayment"},[s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),s("div",{staticClass:"container"},[t._m(0),t._v(" "),s("div",{staticClass:"row justify-content-center mt-4 pb-5"},[s("div",{staticClass:"col-md-10"},[s("form",{staticClass:"border border-sbtan rounded py-4 px-5",on:{submit:function(e){return e.preventDefault(),t.creatrOrder(e)}}},[s("div",{staticClass:"h4"},[t._v("訂單詳細資料")]),t._v(" "),s("div",{staticClass:"form-group"},[s("ValidationProvider",{attrs:{name:"姓名",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.failed,r=e.errors;return[s("label",{attrs:{for:"name"}},[t._v("收件者姓名")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control",class:{"is-invalid":a},attrs:{type:"text",name:"name",id:"username",placeholder:"請輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger"},[t._v(t._s(r[0]))])]}}])})],1),t._v(" "),s("div",{staticClass:"form-row"},[s("div",{staticClass:"col-md-6"},[s("ValidationProvider",{attrs:{name:"聯絡電話",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.failed,r=e.errors;return[s("label",{attrs:{for:"tel"}},[t._v("聯絡電話")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control",class:{"is-invalid":a},attrs:{type:"tel",name:"tel",id:"usertel",placeholder:"請輸入電話"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger"},[t._v(t._s(r[0]))])]}}])})],1),t._v(" "),s("div",{staticClass:"col-md-6"},[s("ValidationProvider",{attrs:{name:"付款方式",rules:"required"}},[s("label",{attrs:{for:"payment"}},[t._v("付款方式")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.form.user.payment,expression:"form.user.payment"}],staticClass:"form-control",attrs:{name:"payment",id:"payment"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.form.user,"payment",e.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"selected"}},[t._v("請選擇付款方式")]),t._v(" "),s("option",{attrs:{value:"COD"}},[t._v("貨到付款")]),t._v(" "),s("option",{attrs:{value:"CVS"}},[t._v("超商付款")]),t._v(" "),s("option",{attrs:{value:"ATM"}},[t._v("ATM轉帳")])]),t._v(" "),s("span",{staticClass:"text-danger"},[t._v(t._s(t.errors[0]))])])],1)]),t._v(" "),s("div",{staticClass:"form-group"},[s("ValidationProvider",{attrs:{name:"收件地址",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.failed,r=e.errors;return[s("label",{attrs:{for:"useraddress"}},[t._v("收件地址")]),t._v(" "),s("div",{staticClass:"form-group mt-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control",class:{"is-invalid":a},attrs:{type:"address",name:"address",id:"useraddress",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger"},[t._v(t._s(r[0]))])])]}}])})],1),t._v(" "),s("div",{staticClass:"form-group"},[s("ValidationProvider",{attrs:{name:"E-mail",rules:"required|email"}},[s("label",{attrs:{for:"userEmail"}},[t._v("E-mail")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control",attrs:{type:"email",name:"email",id:"useremail",placeholder:"請輸入電子信箱"},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger"},[t._v(t._s(t.errors[0]))])])],1),t._v(" "),t._m(1),t._v(" "),"COD"===t.form.user.payment?s("div",{staticClass:"form-group notice"},[t._m(2),t._v(" "),t._m(3)]):t._e(),t._v(" "),"CVS"===t.form.user.payment?s("div",{staticClass:"form-group notice"},[t._m(4),t._v(" "),t._m(5)]):t._e(),t._v(" "),"ATM"===t.form.user.payment?s("div",{staticClass:"form-group notice"},[t._m(6),t._v(" "),t._m(7)]):t._e(),t._v(" "),s("div",{staticClass:"text-right mt-5"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.goBack(e)}}},[t._v("上一步")]),t._v(" "),s("button",{staticClass:"btn btn-danger ml-2",attrs:{type:"submit"}},[t._v("下一步")])])])])])]),t._v(" "),t._m(8)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row text-center p-5"},[e("div",{staticClass:"col-md-3 alert alert-success alert-rounded"},[e("i",{staticClass:"fas fa-check-circle"}),this._v("\n                確認購物車　　\n                "),e("i",{staticClass:"fas fa-angle-double-right"})]),this._v(" "),e("div",{staticClass:"col-md-3 alert alert-success alert-rounded"},[this._v("\n                填寫訂單資料　　\n                "),e("i",{staticClass:"fas fa-angle-double-right"})]),this._v(" "),e("div",{staticClass:"col-md-3 alert alert-dark alert-rounded",attrs:{role:"alert"}},[this._v("確認訂單資料")]),this._v(" "),e("div",{staticClass:"col-md-3 alert alert-dark alert-rounded"},[this._v("完成訂購")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"message"}},[this._v("訂單備註")]),this._v(" "),e("textarea",{staticClass:"form-control",attrs:{name:"email",id:"message",rows:"3"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{staticClass:"text-sborange"},[this._v("PAYMENT\n                            "),e("i",{staticClass:"fas fa-truck"}),this._v(" | 貨到付款\n                        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"text-sbbrown"},[e("li",[this._v("商品皆使用「冷凍宅配」以維持食物的新鮮與完整")]),this._v(" "),e("li",[this._v("商品配送及貨到付款，皆統一委由番茄宅急便處理(配送地點限台灣本島)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{staticClass:"text-sborange"},[this._v("PAYMENT\n                            "),e("i",{staticClass:"fas fa-store-alt"}),this._v(" | 超商付款\n                        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"text-sbbrown"},[e("li",[this._v("可至7-11、全家、萊爾富、OK便利商店進行列印單據並且繳款")]),this._v(" "),e("li",[this._v("在完成訂單的頁面，會顯示您此筆交易專屬的超商代碼，請記下這組代碼至鄰近的超商利用服務機器列印帳單進行繳費")]),this._v(" "),e("li",[this._v("繳費期限為訂單成立時間起24小時內須完成交易，若逾期超商代碼將失效，並自動取消訂單")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{staticClass:"text-sborange"},[this._v("PAYMENT\n                            "),e("i",{staticClass:"fas fa-cash-register"}),this._v(" | ATM轉帳\n                        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"text-sbbrown"},[e("li",[this._v("在完成訂單的頁面，會顯示您此筆交易專屬的付款帳號，請記下這組代碼進行繳費")]),this._v(" "),e("li",[this._v("繳費期限為訂單成立時間起24小時內須完成交易，若逾期超商代碼將失效，並自動取消訂單")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{id:"leaveModal",tabindex:"-1",role:"dialog","aria-hidden":"true","data-backdrop":"static"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-body"},[e("p",[this._v("尚未完成訂購流程，請確認是否離開此頁？")])]),this._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary cancel",attrs:{type:"button","data-dismiss":"modal"}},[this._v("取消")]),this._v(" "),e("button",{staticClass:"btn btn-danger confirm",attrs:{type:"button","data-dismiss":"modal"}},[this._v("確定")])])])])])}]},o=s("VU/8")(i,n,!1,null,null,null);e.default=o.exports}});
//# sourceMappingURL=9.d3d6962bc64ccd1dedbd.js.map